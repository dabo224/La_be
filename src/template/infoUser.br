<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Profile - Responsive</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            background-color: #f0f2f5;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.4;
        }
        
        nav {
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .info-corp {
            position: absolute;
            top: 50px;
            width: 100%;
            padding: 0 10px;
        }
        
        .infoUSer {
            display: grid;
            grid-template-columns: 1fr 40% 1fr;
            width: 100%;
            gap: 20px;
        }
        
        .section-info {
            padding: 15px;
            position: relative;
            display: grid;
            grid-template-columns: 1fr 40% 1fr;
            background-color: white;
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }
        
        .section-info .info-user {
            display: flex;
            justify-content: space-between;
            align-items: center;
            grid-column: 2/3;
            gap: 15px;
        }
        
        .section-info .info-user .user {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .section-info .info-user .user p {
            margin: 0;
            font-weight: 600;
            font-size: 16px;
            color: #333;
        }
        
        .section-info img {
            height: 40px;
            width: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .section-info .info-user .option {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-info .info-user .option .bouton {
            display: flex;
            align-items: center;
            background-color: #1877f2;
            color: white;
            height: auto;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border: none;
            font-size: 14px;
            min-height: 44px;
            gap: 8px;
        }
        
        .section-info .info-user .option .bouton:hover {
            background-color: #166fe5;
        }
        
        .section-info .info-user .option .bouton p {
            margin: 0;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .zone-filtre {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px;
            grid-column: 2/3;
            background-color: white;
            margin-top: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .zone-filtre p {
            margin: 0;
            font-weight: 700;
            font-size: 18px;
            color: #333;
        }
        
        .zone-filtre .filtre {
            background-color: #f0f2f5;
            display: flex;
            align-items: center;
            height: auto;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            gap: 6px;
            min-height: 44px;
        }
        
        .zone-filtre .filtre:hover {
            background-color: #e4e6ea;
        }
        
        .zone-filtre .filtre p {
            margin: 0;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Posts Section */
        .zone-post {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            width: 100%;
        }
        
        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 0;
        }
        
        .post-header img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 12px;
            object-fit: cover;
        }
        
        .post-header .username {
            font-weight: 600;
            font-size: 15px;
            color: #333;
        }
        
        .post-content {
            margin-bottom: 15px;
        }
        
        .post-content p {
            margin: 0 0 10px 0;
            font-size: 15px;
            line-height: 1.5;
            color: #333;
        }
        
        .post-content img {
            width: 100%;
            border-radius: 8px;
            max-height: 500px;
            object-fit: cover;
        }
        
        .post-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e4e6ea;
        }
        
        .likes, .other {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .likes svg, .other svg, .other img {
            width: 24px;
            height: 24px;
        }
        
        .likes p, .other p {
            margin: 0;
            font-size: 14px;
            color: #65676b;
        }
        
        .post-actions {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
        }
        
        .post-actions > div {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            flex: 1;
            justify-content: center;
            min-height: 44px;
        }
        
        .post-actions > div:hover {
            background-color: #f0f2f5;
        }
        
        .post-actions > div p {
            margin: 0;
            font-size: 15px;
            color: #65676b;
            font-weight: 500;
        }
        
        .post-actions > div svg, .post-actions > div img {
            width: 20px;
            height: 20px;
        }
        
        .active-like svg {
            fill: #1877f2;
        }
        
        .active-like p {
            color: #1877f2;
        }
        
        /* Form Styles */
        form {
            display: grid;
            grid-template-columns: 40px 1fr auto;
            gap: 12px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        form img {
            height: 32px;
            width: 32px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        form input {
            border-radius: 20px;
            border: 1px solid #e4e6ea;
            background-color: #f0f2f5;
            outline: none;
            padding: 8px 16px;
            font-size: 14px;
            min-height: 36px;
        }
        
        form input:focus {
            border-color: #1877f2;
            background-color: white;
        }
        
        form button {
            background-color: #1877f2;
            border-radius: 6px;
            border: none;
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            min-height: 36px;
            transition: background-color 0.2s ease;
        }
        
        form button:hover {
            background-color: #166fe5;
        }
        
        /* Comments Section */
        .comment-action {
            display: none;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .comment-action h4 {
            margin: 0;
            font-size: 16px;
            color: #333;
        }
        
        .comment-action .close {
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }
        
        .comment-action .close:hover {
            background-color: #f0f2f5;
        }
        
        .section-comment {
            max-height: 30vh;
            overflow-y: auto;
            scrollbar-width: none;
        }
        
        .section-comment::-webkit-scrollbar {
            display: none;
        }
        
        .grand-comments {
            display: none;
            margin-bottom: 10px;
        }
        
        .comments {
            display: flex;
            gap: 8px;
            align-items: flex-start;
        }
        
        .comments img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .comment {
            background-color: #f0f2f5;
            padding: 8px 12px;
            border-radius: 16px;
            flex: 1;
        }
        
        .comment .username {
            font-weight: 600;
            font-size: 13px;
            color: #333;
            margin-bottom: 2px;
        }
        
        .comment .comment-text {
            font-size: 14px;
            color: #333;
            line-height: 1.4;
        }
        
        #infoUser-retire {
            background-color: #e74c3c !important;
        }
        
        #infoUser-retire:hover {
            background-color: #c0392b !important;
        }
        
        /* Responsive Design */
        
        /* Tablet Portrait */
        @media (max-width: 1024px) {
            .infoUSer {
                grid-template-columns: 1fr 60% 1fr;
            }
            
            .section-info {
                grid-template-columns: 1fr 60% 1fr;
            }
            
            .zone-filtre {
                grid-column: 2/3;
            }
        }
        
        /* Mobile Landscape and Tablet Portrait */
        @media (max-width: 768px) {
            .info-corp {
                top: 60px;
                padding: 0 15px;
            }
            
            .infoUSer {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .section-info {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .section-info .info-user {
                grid-column: 1;
                flex-direction: column;
                gap: 15px;
            }
            
            .section-info .info-user .user {
                justify-content: center;
                text-align: center;
            }
            
            .section-info .info-user .option {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .zone-filtre {
                grid-column: 1;
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            
            .zone-filtre .filtre {
                width: 100%;
                justify-content: center;
            }
            
            .post-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .post-actions > div {
                justify-content: flex-start;
                padding: 12px 16px;
            }
            
            form {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            form img {
                display: none;
            }
            
            .post-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
        
        /* Mobile Portrait */
        @media (max-width: 480px) {
            .info-corp {
                padding: 0 10px;
            }
            
            .section-info {
                padding: 12px;
            }
            
            .section-info .info-user .user p {
                font-size: 14px;
            }
            
            .section-info .info-user .option .bouton {
                padding: 6px 12px;
                font-size: 12px;
                min-height: 40px;
            }
            
            .section-info .info-user .option .bouton p {
                font-size: 12px;
            }
            
            .zone-post {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .post-header .username {
                font-size: 14px;
            }
            
            .post-content p {
                font-size: 14px;
            }
            
            .post-actions > div {
                padding: 10px 12px;
            }
            
            .post-actions > div p {
                font-size: 14px;
            }
            
            form input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            form button {
                font-size: 14px;
            }
            
            .comment-action h4 {
                font-size: 14px;
            }
        }
        
        /* Extra Small Mobile */
        @media (max-width: 320px) {
            .info-corp {
                padding: 0 5px;
            }
            
            .section-info {
                padding: 10px;
            }
            
            .zone-post {
                padding: 12px;
            }
            
            .section-info .info-user .option {
                flex-direction: column;
                width: 100%;
            }
            
            .section-info .info-user .option .bouton {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* High DPI Displays */
        @media (min-resolution: 2dppx) {
            .section-info img,
            .post-header img,
            .comments img,
            form img {
                image-rendering: -webkit-optimize-contrast;
            }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #18191a;
                color: #e4e6ea;
            }
            
            .section-info,
            .zone-filtre,
            .zone-post {
                background-color: #242526;
                color: #e4e6ea;
            }
            
            .zone-filtre .filtre,
            form input,
            .comment {
                background-color: #3a3b3c;
                color: #e4e6ea;
                border-color: #3a3b3c;
            }
            
            .post-actions > div:hover,
            .zone-filtre .filtre:hover {
                background-color: #3a3b3c;
            }
            
            .post-header .username,
            .zone-filtre p,
            .comment-action h4,
            .comment .username {
                color: #e4e6ea;
            }
            
            .likes p,
            .other p,
            .post-actions > div p {
                color: #b0b3b8;
            }
        }
        
        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Focus styles for better accessibility */
        .section-info .info-user .option .bouton:focus,
        .zone-filtre .filtre:focus,
        .post-actions > div:focus,
        form button:focus,
        form input:focus {
            outline: 2px solid #1877f2;
            outline-offset: 2px;
        }
        
        /* Print styles */
        @media print {
            .section-info .info-user .option,
            .post-actions,
            form,
            .comment-action {
                display: none !important;
            }
            
            body {
                background-color: white !important;
            }
            
            .section-info,
            .zone-filtre,
            .zone-post {
                background-color: white !important;
                box-shadow: none !important;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <%- include('./partials/header') %>
    
    <section class="info-corp">
        <div class="section-info">
            <div id="infoUser-userId" data-userid="<%=user.id %>" class="info-user">
                <div class="user">
                    <img src="/static/profil/<%= user.Profil.urlPhoto %>" alt="User Profile">
                    <p><%= user.prenom + ' '+ user.nom %></p>
                </div>
                <div class="option">
                    <% if (user.Friends.length){ %>
                        <div id="infoUser-retire" data-userid="<%=user.id %>" class="bouton">
                            <svg width="20px" height="20px" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke-width="3" stroke="currentColor" fill="none">
                                <circle cx="29.22" cy="16.28" r="11.14"/>
                                <path d="M41.32,35.69c-2.69-1.95-8.34-3.25-12.1-3.25h0A22.55,22.55,0,0,0,6.67,55h29.9"/>
                                <circle cx="45.38" cy="46.92" r="11.94"/>
                                <line x1="45.98" y1="39.8" x2="45.98" y2="53.8"/>
                                <line x1="38.98" y1="46.8" x2="52.98" y2="46.8"/>
                            </svg>
                            <p>Vous êtes amis</p>
                        </div>    
                    <%}else if ( notif) { %>
                        <div id="infoUser-retire" data-userid="<%=user.id %>" class="bouton">
                            <svg width="20px" height="20px" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke-width="3" stroke="currentColor" fill="none">
                                <circle cx="29.22" cy="16.28" r="11.14"/>
                                <path d="M41.32,35.69c-2.69-1.95-8.34-3.25-12.1-3.25h0A22.55,22.55,0,0,0,6.67,55h29.9"/>
                                <circle cx="45.38" cy="46.92" r="11.94"/>
                                <line x1="45.98" y1="39.8" x2="45.98" y2="53.8"/>
                                <line x1="38.98" y1="46.8" x2="52.98" y2="46.8"/>
                            </svg>
                            <p data-anuler="<%= notif.id %>">Annuler la Demande</p>
                        </div>    
                    <% } else { %>
                        <div id="infoUser-ajout" data-userid="<%=user.id %>" class="bouton">
                            <svg width="20px" height="20px" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke-width="3" stroke="currentColor" fill="none">
                                <circle cx="29.22" cy="16.28" r="11.14"/>
                                <path d="M41.32,35.69c-2.69-1.95-8.34-3.25-12.1-3.25h0A22.55,22.55,0,0,0,6.67,55h29.9"/>
                                <circle cx="45.38" cy="46.92" r="11.94"/>
                                <line x1="45.98" y1="39.8" x2="45.98" y2="53.8"/>
                                <line x1="38.98" y1="46.8" x2="52.98" y2="46.8"/>
                            </svg>
                            <p>Ajouter ami(e)</p>
                        </div>
                    <% } %>
                    <svg fill="currentColor" width="30px" height="30px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" id="Glyph" version="1.1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <path d="M16,13c-1.654,0-3,1.346-3,3s1.346,3,3,3s3-1.346,3-3S17.654,13,16,13z" id="XMLID_287_"/>
                        <path d="M6,13c-1.654,0-3,1.346-3,3s1.346,3,3,3s3-1.346,3-3S7.654,13,6,13z" id="XMLID_289_"/>
                        <path d="M26,13c-1.654,0-3,1.346-3,3s1.346,3,3,3s3-1.346,3-3S27.654,13,26,13z" id="XMLID_291_"/>
                    </svg>
                </div>
            </div>
        </div>
        
        <section class="infoUSer">
            <div class="left"></div>
            <div class="user-post">
                <div class="post">
                    <div class="zone-filtre">
                        <p>Publications</p>
                        <div class="filtre">
                            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M15 10.5A3.502 3.502 0 0 0 18.355 8H21a1 1 0 1 0 0-2h-2.645a3.502 3.502 0 0 0-6.71 0H3a1 1 0 0 0 0 2h8.645A3.502 3.502 0 0 0 15 10.5zM3 16a1 1 0 1 0 0 2h2.145a3.502 3.502 0 0 0 6.71 0H21a1 1 0 1 0 0-2h-9.145a3.502 3.502 0 0 0-6.71 0H3z" fill="currentColor"/>
                            </svg>
                            <p>Filtres</p>
                        </div>
                    </div>
                    
                    <% user.Posts.forEach(post => { %>
                        <div class="zone-post" data-userid="<%= post.User.id %>" data-postid="<%= post.id %>">
                            <div class="post-header">
                                <% if (post.User.Profil && post.User.Profil.urlPhoto) { %>
                                    <img src="/static/profil/<%=post.User.Profil.urlPhoto %>" alt="User Avatar">
                                <% } else { %>
                                    <img src="/static/images/images/FB_IMG_1727683607286.jpg" alt="User Avatar">
                                <% } %>
                                <div class="username"><%= post.User.prenom %> <%= post.User.nom %></div>
                            </div>
                            <div class="post-content">
                                <p><%= post.contenu %></p>
                                <% if (post.ImagePost && post.ImagePost.urlPhoto) { %>
                                    <img src="/static/images/posts/<%= post.ImagePost.urlPhoto %>" alt="Post Image">
                                <% } %>
                            </div>
                            <div class="post-info">
                                <div class="likes" data-like='<%= JSON.stringify(post.Likes.map(like => like.User.id))%>' data-post-id="<%= post.id %>">
                                    <svg width="24px" height="24px" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M15.9 4.5C15.9 3 14.418 2 13.26 2c-.806 0-.869.612-.993 1.82-.055.53-.121 1.174-.267 1.93-.386 2.002-1.72 4.56-2.996 5.325V17C9 19.25 9.75 20 13 20h3.773c2.176 0 2.703-1.433 2.899-1.964l.013-.036c.114-.306.358-.547.638-.82.31-.306.664-.653.927-1.18.311-.623.27-1.177.233-1.67-.023-.299-.044-.575.017-.83.064-.27.146-.475.225-.671.143-.356.275-.686.275-1.329 0-1.5-.748-2.498-2.315-2.498H15.5S15.9 6 15.9 4.5zM5.5 10A1.5 1.5 0 0 0 4 11.5v7a1.5 1.5 0 0 0 3 0v-7A1.5 1.5 0 0 0 5.5 10z"/>
                                    </svg>
                                    <p id="nblike"><%= post.nblike %></p>
                                </div>
                                <div class="other">
                                    <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 13.5997 2.37562 15.1116 3.04346 16.4525C3.22094 16.8088 3.28001 17.2161 3.17712 17.6006L2.58151 19.8267C2.32295 20.793 3.20701 21.677 4.17335 21.4185L6.39939 20.8229C6.78393 20.72 7.19121 20.7791 7.54753 20.9565C8.88837 21.6244 10.4003 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <p id="nbcomment"><%= post.nbcomment %></p>
                                    <svg width="24px" height="24px" viewBox="0 -0.5 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14.734 15.8974L19.22 12.1374C19.3971 11.9927 19.4998 11.7761 19.4998 11.5474C19.4998 11.3187 19.3971 11.1022 19.22 10.9574L14.734 7.19743C14.4947 6.9929 14.1598 6.94275 13.8711 7.06826C13.5824 7.19377 13.3906 7.47295 13.377 7.78743V9.27043C7.079 8.17943 5.5 13.8154 5.5 16.9974C6.961 14.5734 10.747 10.1794 13.377 13.8154V15.3024C13.3888 15.6178 13.5799 15.8987 13.8689 16.0254C14.158 16.1521 14.494 16.1024 14.734 15.8974Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <p>6</p>
                                </div>
                            </div>
                            
                            <div class="post-actions">
                                <div class="btn_like">
                                    <svg width="20px" height="20px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0501 7.04419C15.4673 5.79254 14.5357 4.5 13.2163 4.5C12.5921 4.5 12.0062 4.80147 11.6434 5.30944L8.47155 9.75H5.85748L5.10748 10.5V18L5.85748 18.75H16.8211L19.1247 14.1428C19.8088 12.7747 19.5406 11.1224 18.4591 10.0408C17.7926 9.37439 16.8888 9 15.9463 9H14.3981L15.0501 7.04419ZM9.60751 10.7404L12.864 6.1813C12.9453 6.06753 13.0765 6 13.2163 6C13.5118 6 13.7205 6.28951 13.627 6.56984L12.317 10.5H15.9463C16.491 10.5 17.0133 10.7164 17.3984 11.1015C18.0235 11.7265 18.1784 12.6814 17.7831 13.472L15.8941 17.25H9.60751V10.7404ZM8.10751 17.25H6.60748V11.25H8.10751V17.25Z" fill="currentColor"/>
                                    </svg>
                                    <p>J'aime</p>
                                </div>
                                <div class="btn_comment">
                                    <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 13.5997 2.37562 15.1116 3.04346 16.4525C3.22094 16.8088 3.28001 17.2161 3.17712 17.6006L2.58151 19.8267C2.32295 20.793 3.20701 21.677 4.17335 21.4185L6.39939 20.8229C6.78393 20.72 7.19121 20.7791 7.54753 20.9565C8.88837 21.6244 10.4003 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <p>Commenter</p>
                                </div>
                                <div>
                                    <svg width="20px" height="20px" viewBox="0 -0.5 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14.734 15.8974L19.22 12.1374C19.3971 11.9927 19.4998 11.7761 19.4998 11.5474C19.4998 11.3187 19.3971 11.1022 19.22 10.9574L14.734 7.19743C14.4947 6.9929 14.1598 6.94275 13.8711 7.06826C13.5824 7.19377 13.3906 7.47295 13.377 7.78743V9.27043C7.079 8.17943 5.5 13.8154 5.5 16.9974C6.961 14.5734 10.747 10.1794 13.377 13.8154V15.3024C13.3888 15.6178 13.5799 15.8987 13.8689 16.0254C14.158 16.1521 14.494 16.1024 14.734 15.8974Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <p>Partager</p>
                                </div>
                            </div>
                            
                            <form class="form" action="post">
                                <img class="photo_profil" src="" alt="Profile">
                                <input type="text" placeholder="Écrivez votre commentaire" name="contenu" id="contenu" autocomplete="off">
                                <button type="submit">Envoyer</button>
                            </form>
                            
                            <div class="comment-action">
                                <h4 class="titreComment">Commentaires</h4>
                                <svg class="close" onclick="fermerFenetre()" fill="currentColor" width="24px" height="24px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
                                    <title>Fermer</title>
                                    <path d="M19.587 16.001l6.096 6.096c0.396 0.396 0.396 1.039 0 1.435l-2.151 2.151c-0.396 0.396-1.038 0.396-1.435 0l-6.097-6.096-6.097 6.096c-0.396 0.396-1.038 0.396-1.434 0l-2.152-2.151c-0.396-0.396-0.396-1.038 0-1.435l6.097-6.096-6.097-6.097c-0.396-0.396-0.396-1.039 0-1.435l2.153-2.151c0.396-0.396 1.038-0.396 1.434 0l6.096 6.097 6.097-6.097c0.396-0.396 1.038-0.396 1.435 0l2.151 2.152c0.396 0.396 0.396 1.038 0 1.435l-6.096 6.096z"></path>
                                </svg>
                            </div>
                            
                            <div class="section-comment">
                                <% if (post.Comments) { %>
                                    <% post.Comments.forEach(comment => { %>
                                        <div class="grand-comments">
                                            <div class="comments">
                                                <img src="/static/profil/<%=comment.User.Profil.urlPhoto %>" alt="User Avatar">
                                                <div class="comment">
                                                    <div class="username"><%= comment.User.nom %></div>
                                                    <div class="comment-text"><%= comment.contenu %></div>
                                                </div>
                                            </div>
                                        </div>
                                    <% }) %>
                                <% } %>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>
            <div class="right"></div>
        </section>
    </section>

    <script>
        // Gestion du champ pour annuler la demande d'ami
        const btn_retire = document.querySelector('#infoUser-retire p');
        if (btn_retire) {
            btn_retire.addEventListener('click', async () => {
                const notif_id = btn_retire.getAttribute('data-anuler');
                const response = await fetch(`/notif/${notif_id}`, {
                    method: 'DELETE',
                });
                location.reload();
            });
        }

        // Gestion du champ ajouter un ami
        const btn_ajout = document.getElementById('infoUser-ajout');
        if (btn_ajout) {
            btn_ajout.addEventListener('click', async () => {
                const userID = btn_ajout.getAttribute('data-userId');
                const response = await fetch('/notif', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ userID, senderId: decode().userId })
                });
                location.reload();
            });
        }

        // Gestion des likes
        document.querySelectorAll('.likes').forEach(like => {
            const likes = JSON.parse(like.getAttribute('data-like'));
            const postId = like.getAttribute('data-post-id');
            likes.forEach(element => {
                if (element == decode().userId) {
                    like.classList.add('active-like');
                }
            });
        });

        // Gestion de l'affichage de la photo de profil
        const photo_profil = document.querySelectorAll(".photo_profil");
        photo_profil.forEach(element => {
            element.src = `/static/profil/${decode().photo}`;
        });

        // Gestion du bouton like
        const btn_like = document.querySelectorAll('.btn_like');
        btn_like.forEach(element => {
            const parent = element.parentElement;
            const section = parent.parentElement;
            const nblike = section.querySelector('#nblike');

            element.addEventListener('click', async () => {
                const send = await fetch(`/post-like/${section.dataset.postid}/${decode().userId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: ''
                });
                const res = await send.json();

                nblike.textContent = res.data;
                if (res.stat) {
                    nblike.parentElement.classList.add('active-like');
                } else {
                    nblike.parentElement.classList.remove('active-like');
                }
            });
        });

        // Gestion de l'envoi des commentaires
        const forms = document.querySelectorAll('.form');
        forms.forEach(form => {
            form.addEventListener('submit', async e => {
                e.preventDefault();
                const grand_comments = e.target.parentElement.querySelector('.grand-comments');
                const section = e.target.parentElement;
                const contenu = e.target.contenu.value;

                const response = await fetch('/post-comment', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        contenu,
                        postId: section.dataset.postid,
                        userId: decode().userId
                    })
                });

                const result = await response.json();

                const new_div = document.createElement('div');
                new_div.className = 'grand-comments';
                new_div.innerHTML = `
                    <div class="comments">
                        <img src="static/profil/${decode().photo}" alt="User Avatar">
                        <div class="comment">
                            <div class="username">Vous</div>    
                            <div class="comment-text">${result.resp.contenu}</div>
                        </div>
                    </div>
                `;

                form.parentElement.querySelector('#nbcomment').textContent = result.count;
                grand_comments.prepend(new_div);
                form.reset();
            });
        });

        // Gestion des commentaires
        const btn_comment = document.querySelectorAll('.btn_comment');
        btn_comment.forEach(btn => {
            btn.addEventListener('click', e => {
                const inter = btn.parentElement;
                inter.parentElement.querySelector('.comment-action').style.display = 'flex';
                inter.parentElement.querySelectorAll('.grand-comments').forEach(div => {
                    div.style.display = 'block';
                });
            });
        });

        const close = document.querySelectorAll('.close');
        close.forEach(btn => {
            btn.addEventListener('click', e => {
                const inter = btn.parentElement;
                inter.parentElement.querySelector('.comment-action').style.display = 'none';
                inter.parentElement.querySelectorAll('.grand-comments').forEach(div => {
                    div.style.display = 'none';
                });
            });
        });

        // Function placeholder for decode() - you'll need to implement this
        function decode() {
            // This should return user data from your authentication system
            return {
                userId: 'current-user-id',
                userNom: 'Current User',
                userPrenom: 'Current',
                all: 'Current User Full Name',
                photo: 'default-avatar.jpg'
            };
        }
    </script>
</body>
</html>